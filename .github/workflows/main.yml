name: CI/CD Workflow

on:
  push:
    branches:
      - main  # Este flujo de trabajo se ejecuta solo cuando se hace un push a la rama 'main'
  pull_request:
    branches:
      - main  # Este flujo de trabajo también se ejecuta cuando se hace un pull request hacia la rama 'main'

permissions:
  contents: read  # Permisos para leer el contenido del repositorio

jobs:
  build-and-test:
    runs-on: ubuntu-latest  # Este flujo de trabajo se ejecutará en un entorno Ubuntu

    steps:
      - name: Checkout code
        uses: actions/checkout@v2  # Este paso obtiene el código de tu repositorio

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'  # Configura la versión de Node.js que tu proyecto usa (ajusta la versión si es otra)

      - name: Install dependencies
        run: npm install  # Instala las dependencias de tu proyecto

      - name: Run tests
        run: npm test  # Ejecuta las pruebas automáticas

  deploy:
    runs-on: ubuntu-latest
    needs: build-and-test  # Este paso solo se ejecuta si las pruebas pasan

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4.1.1
        with:
          branch: gh-pages  # La rama donde se desplegará el sitio (puede ser 'gh-pages')
          folder: .  # El directorio donde están tus archivos estáticos (ajusta si es otro)
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # Token de autenticación de GitHub
